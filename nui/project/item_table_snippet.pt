<tal:macro metal:define-macro="contents_table_wrapper">
 <tal:setvar define="item_collection item_collection | options/item_collection;
                     item_header item_header | item_collection/info/header;
                     item_type item_type | item_collection/item_type;
                     item_date_author_header item_date_author_header | options/item_date_author_header;
                     ">
  <tal:if condition="item_collection/editable">
    <tal:metal metal:use-macro="view/item_table_snippet/macros/contents_table" />
  </tal:if>

  <tal:if condition="not:item_collection/editable">
    <tal:metal metal:use-macro="view/item_table_snippet/macros/contents_table_uneditable" />
  </tal:if> 
 </tal:setvar>
</tal:macro>

<tal:if condition="nothing"> <!-- hack to prevent non-macro execution -->
<tal:macro metal:define-macro="contents_table"
     define="form_name string:${item_type}_contents">
<div class="oc-widget oc-widget-dataTable">
  <h2 class="oc-dataTable-heading"><tal:dummy replace="item_header" /></h2>

  <form action="contents"
  tal:attributes="name form_name">
    <input tal:replace="structure view/authenticator_input"/>
    <input type="hidden" name="item_type"
      tal:attributes="value item_type" /> 
    <table class="oc-dataTable" cellpadding="0" cellspacing="0">
      <tal:macro metal:use-macro="view/item_thead_snippet/macros/item_thead_snippet" />
      <tal:macro metal:use-macro="view/item_tbody_snippet/macros/item_tbody_snippet" />
    </table>

    <ul class="oc-actions oc-dataTable-actions" tal:condition="python: item_type != 'pages' or len(item_collection) > 1">
      <tal:if condition="show_deletes">
        <li>
          <input type="submit" name="task|batch_deletes|delete" value="Delete" class="oc-button" />
        </li>
      </tal:if>
    </ul>
  </form>
</div> <!-- end .oc-widget-dataTable -->
</tal:macro>
</tal:if>

<tal:if condition="nothing"> <!-- hack to prevent non-macro execution -->
<tal:macro metal:define-macro="contents_table_uneditable">
<div class="oc-widget oc-widget-dataTable">
  <h2 class="oc-dataTable-heading"><tal:dummy replace="item_header" /></h2>
  <table class="oc-dataTable" cellpadding="0" cellspacing="0">
    <tal:macro metal:use-macro="view/item_thead_snippet/macros/item_thead_snippet" />
    <tal:macro metal:use-macro="view/item_tbody_snippet/macros/item_tbody_snippet" />
  </table>

</div> <!-- end .oc-widget-dataTable -->
</tal:macro>
</tal:if>
