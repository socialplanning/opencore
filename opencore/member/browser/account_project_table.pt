<tal:macro metal:define-macro="project_table">
  <tal:projects_table define="projinfos view/projects_for_user">
    <div id="project_table"
         class="oc-widget oc-widget-dataTable oc-clearAfter"
         tal:condition="projinfos"
         >
      <h2 class="oc-toggleFold oc-dataTable-heading">
        Projects you belong to (<span id="num_projs" tal:content="python: len(projinfos)" />)
      </h2>      
      <form class="" action="account">
        <table id="" class="oc-dataTable" cellpadding="0" cellspacing="0">
          <thead>
            <tr>
              <th class="" style="width: 10px;" scope="col"><input class="oc-checkAll" type="checkbox" /></th>
              <th class="oc-columnSortable" style="width: 200px;" scope="col">Project </th>
              <th class="oc-columnSortable" scope="col">Role</th>
              <th class="oc-columnSortable" scope="col">Since</th>
              <th class="oc-columnSortable" scope="col">Listed</th>
              <th class="oc-columnAction" scope="col">Actions</th>
            </tr>
          </thead>
          <tbody id="projinfos_for_user">
            <tal:for repeat="projinfo projinfos">
              <tal:var define="proj_id projinfo/proj_id">
                <tal:macro metal:use-macro="view/project_row/macros/project_row" />
              </tal:var>
            </tal:for>
          </tbody>
        </table>
        <ul class="oc-actions oc-dataTable-actions">
          <li>
            <input type="submit" name="task|batch_check|leave" value="Leave projects"
                   class="oc-button oc-chooseThis oc-js-actionButton" />
          </li>
          <noscript>
            <li>
              <input type="submit" name="task|batch_check|change-listing" value="Change listing"
                     class="oc-button" />
            </li>
          </noscript>
        </ul>
      </form>
    
    <!-- end .widget-table --></div>

    <tal:no_updates condition="not: projinfos">
      <div id="project_table">
        <h2>You don't belong to any projects.</h2>
        <p>Why not <a tal:attributes="href python:view.url_for('projects')">look for a project to join</a> or
        <a tal:attributes="href python:view.url_for('project_create')">start your own</a>?</p>
      </div>
    </tal:no_updates>

  </tal:projects_table>
</tal:macro>
