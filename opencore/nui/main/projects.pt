<html metal:use-macro="here/@@standard_macros/master">
  <head>
    <title metal:fill-slot="title">Projects - OpenPlans</title>
  </head>
  <body>
    <div metal:fill-slot="content">              
      <div class="oc-headingBlock">
        <h1>Projects on OpenPlans</h1>
        <p class="oc-headingContext">Currently serving <span tal:replace="view/projects_served_count"/> projects</p>
      </div>
      <div id="oc-content-main">
        
        <tal:set_var define="current_search_page string:projects;
           form_action_url string:${context/portal_url}/projects/searchresults">
          <div metal:use-macro="here/main_macros/search_widget" />
        </tal:set_var>

        <!-- list of recently updated projects. XXX maybe create a macro out of this? Generic for recent content? -->
        <div class="oc-widget oc-widget-feed">
          <h2 class="oc-feed-title">Recently updated projects</h2>
          <ul class="oc-feed-list">
            <li class="oc-feed-item oc-clearAfter" tal:repeat="project view/recently_updated_projects">
              <!-- XXX project logo with brains? --> <!-- NOTE once images do exist this div will NOT be conditional but its contents will -->
              <!--div class="oc-project-logo" tal:condition="project/logo | nothing">
                <a tal:attributes="href python:view.project_url(project/absolute_url" tal:condition="project/logo | nothing">
                  <img src="" tal:attributes="src project/image_src | nothing; alt project/Title; title project/Title" tal:condition="project/logo | nothing" />
                </a>
              </div-->
              <h3 class="oc-feed-item-title">
                <a href="" tal:attributes="href python:view.project_url(project)" tal:content="project/Title">Project Title</a>
              </h3>
              <p class="oc-feed-item-data oc-discreetText" tal:define="nmembers python:view.n_project_members(project)">
                <span tal:replace="nmembers">YY</span>
                member<span tal:condition="python: nmembers != 1" tal:replace="string:s" />,
                last updated <span tal:replace="python: view.pretty_date(project.ModificationDate)" />
              </p>
              <p class="oc-feed-item-description" tal:define="desc project/Description">
                <span tal:condition="desc" tal:replace="desc" />
              </p>
            </li>
          </ul>
        </div>
        
      </div><!-- content-main -->
      
      
      <!-- XXX we need to think about how we are going to implement this with dynamic data
           wiki page snippet pulled from a particular location? -->
      <!-- content-sidebar -->
      <div id="oc-content-sidebar">
        <div class="oc-getstarted" tal:condition="view/loggedin">
          <h2>Get started&hellip;</h2>
          <p>Can&rsquo;t find a project you are interested in? See a need that is not being met?
          </p>
           <a tal:attributes="href string:${view/siteURL}/projects/create" class="oc-banana">Start a new project</a>
        </div>
        <div class="oc-boxy" tal:content="structure python: view.render_static('main_projects_featured_projects.txt')" />
      </div>
    </div><!-- content-fill-slot -->
    
  </body>
</html>
